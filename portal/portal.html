<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>My Portal</title>

	<link rel="stylesheet" type="text/css" href="portal_files/potree.css">
	<link rel="stylesheet" type="text/css" href="portal_files/jquery-ui.css">
	<link rel="stylesheet" href="portal_files/ol.css" type="text/css">
  </head>

  <body>
  
	<script src="portal_files/jquery-2.js"></script>
	<script src="portal_files/jquery-ui.js"></script>
	<script src="portal_files/three.js"></script>
	<script src="portal_files/stats.js"></script>
	<script src="portal_files/BinaryHeap.js"></script>
	<script src="portal_files/tween.js"></script>
	<script src="portal_files/d3.js"></script>
	<script src="portal_files/proj4.js"></script>
	<script src="portal_files/ol.js"></script>
	
	<script src="portal_files/potree.js"></script>
	
	<script src="portal_files/laslaz_002.js"></script>
	<script src="portal_files/bluebird.js"></script>
	<script src="portal_files/laslaz.js"></script>
	
	<script src="portal_files/laslaz_002.js"></script>
	<script src="portal_files/bluebird.js"></script>
	<script src="portal_files/laslaz.js"></script>
	

    <div class="potree_container" style="position: absolute; width: 100%; height: 100%; left: 0px; top: 0px; ">
	
		<div style="left: 300px;" id="potree_render_area">
			<img class="potree_menu_toggle" src="portal_files/menu_button.svg"><img id="potree_map_toggle" style="display: none;" src="portal_files/map_icon.png"><div id="potree_map" class="mapBox" style="position: absolute; left: 50px; top: 50px; width: 400px; height: 400px; display: none">
				<div id="potree_map_header" style="position: absolute; width: 100%; height: 25px; top: 0px; background-color: rgba(0,0,0,0.5); z-index: 1000; border-top-left-radius: 3px; border-top-right-radius: 3px;">
				</div>
				<div id="potree_map_content" class="map" style="position: absolute; z-index: 100; top: 25px; width: 100%; height: calc(100% - 25px); border: 2px solid rgba(0,0,0,0.5); box-sizing: border-box;"></div>
			</div>
		
			<!-- HEADING -->
			<div id="potree_description" class="potree_info_text"></div>
		<canvas tabindex="2222" style="width: 1620px; height: 629px;" height="629" width="1620"></canvas><div id="profile_window" style="position: absolute; width: 100%; height: 30%; bottom: 0px; border: 1px solid black; display: none; box-sizing: border-box;">
	
	<div id="profile_titlebar" class="pv-titlebar" style="display: flex; position: absolute; height: 30px; width: 100%; box-sizing: border-box;">
		<span style="padding-right: 10px">Height Profile</span>
		<span id="profileInfo" style="flex-grow: 1; flex-direction: row"> </span>
		<span id="profile_toggle_size_button" class="ui-icon ui-icon-newwin profile-button"> </span>
		<span id="closeProfileContainer" class="ui-icon ui-icon-close profile-button"> </span>
	</div>
	
	<div style="position: absolute; top: 30px; width: 100%; height: calc(100% - 30px); box-sizing: border-box;" class="pw_content">
		
		<span class="pv-main-color" style="height: 100%; width: 100%; padding: 5px; display:flex; flex-direction: column; box-sizing: border-box;">
			<div style=" width: 100%; color: #9d9d9d; margin: 5px; display: flex; flex-direction: row; box-sizing: border-box;">
				<span>Points in profile: </span>
				<span id="profile_num_points">-</span>
				<!--<span id="profile_threshold" style="width: 300px">
					Threshold: <span id="potree_profile_threshold_label">123</span> <div id="potree_profile_threshold_slider"></div>
				</span>-->
				<span style="flex-grow: 1;"></span>
				<span>
					<a id="potree_download_profile_link" href="#" download="profile.las">
						<input id="potree_download_profile_button" value="save" type="button">
					</a>
				</span>
			</div>
			
			<div id="profile_draw_container" style="
				width: 100%; 
				flex-grow: 1; 
				position: relative; height: 100%; 
				box-sizing: border-box;">
				<div style="
					position: absolute; 
					left: 41px; 
					top: 0; 
					bottom: 20; 
					width: calc(100% - 41px); 
					height: calc(100% - 20px); 
					background-color: #000000;
					"></div>
				<svg id="profileSVG" style="
					fill: #9d9d9d;
					position: absolute; 
					left: 0; right: 0; 
					top: 0; bottom: 0; 
					width: 100%; 
					height: 100%;
					"></svg>
				<canvas id="profileCanvas" style="
					position: absolute; 
					left: 41px; 
					top: 0; 
					bottom: 20; 
					width: calc(100% - 41px); 
					height: calc(100% - 20px); 
					/*background-color: #000000;*/
					"></canvas>
				<div id="profile_selection_marker" style="position: absolute; pointer-events:none;"></div>
				
			</div>
		</span>
	</div>

</div><script>


//$( "#potree_profile_threshold_slider" ).slider({
//		value: 20*1000,
//		min: 5000,
//		max: 100*1000,
//		step: 100,
//		slide: function( event, ui ) {viewer._2dprofile.setThreshold(ui.value);}
//	});

$('#potree_download_profile_button').click(function(){
	var las = viewer._2dprofile.getLAS();
	var u8view = new Uint8Array(las);
	
	var binString = "";
	for(var i = 0; i < u8view.length; i++){
		binString += String.fromCharCode(u8view[i]);
	}
	
	var uri = "data:application/octet-stream;base64,"+btoa(binString);
	$('#potree_download_profile_link').attr("href", uri);
	//elDownloadProfileLink.href = uri;
	
});

</script></div>
		
		<div style="width: 300px; height: 100%;" id="potree_sidebar_container">

<div class="navmenu navmenu-default navmenu-fixed-left unselectable" style="min-height: 100%; height: 100%; border: 1px solid red">
	<span class="potree_sidebar_brand" style="display: flex; flex-direction: row">
		<a href="http://potree.org/" target="_blank">potree.org</a> 
		<span style="margin: 0px 3px; color: #9AA1A4"> - </span> 
		<a href="https://github.com/potree/potree" target="_blank">github</a>
		<span style="margin: 0px 3px; color: #9AA1A4"> - </span> 
		<a href="https://twitter.com/m_schuetz" target="_blank">twitter</a>
		<span style="flex-grow: 1"></span>
		<span id="potree_version_number" style="color: #9AA1A4; font-size: 80%; font-weight: 100">1.4RC</span>
	</span>
  
  <div role="tablist" id="accordion" class="accordion ui-accordion ui-widget ui-helper-reset">
	  <h3 tabindex="0" aria-expanded="true" aria-selected="true" aria-controls="ui-id-2" id="ui-id-1" role="tab" class="ui-accordion-header ui-state-default ui-accordion-header-active ui-state-active ui-corner-top ui-accordion-icons"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-s"></span>Appearance</h3>
	  <div aria-hidden="false" role="tabpanel" aria-labelledby="ui-id-1" id="ui-id-2" style="display: block;" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content-active">
	  <ul class="pv-menu-list">
	  
		<li>Point Budget: <span id="lblPointBudget">1,000,000</span> <div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sldPointBudget"><span style="left: 18.3673%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div>	</li>
		<li>Point Size: <span id="lblPointSize">1.43</span> <div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sldPointSize"><span style="left: 47.6667%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div>		</li>
		<li>Field of View: <span id="lblFOV">60</span><div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sldFOV"><span style="left: 50%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div>					</li>
		<li>Opacity: <span id="lblOpacity">1.00</span><div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sldOpacity"><span style="left: 100%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div>				</li>
	   
	   <li>
		   <label for="optPointSizing-button" class="pv-select-label">Point Sizing </label>
		   <select style="display: none;" id="optPointSizing" name="optPointSizing">
				<option selected="selected">Fixed</option>
				<option>Attenuated</option>
				<option>Adaptive</option>
			</select><span aria-disabled="false" aria-labelledby="ui-id-19" aria-activedescendant="ui-id-19" style="width: 239px;" aria-haspopup="true" aria-owns="optPointSizing-menu" aria-autocomplete="list" aria-expanded="false" role="combobox" id="optPointSizing-button" tabindex="0" class="ui-selectmenu-button ui-widget ui-state-default ui-corner-all"><span class="ui-icon ui-icon-triangle-1-s"></span><span class="ui-selectmenu-text">Fixed</span></span>
		</li>
		
		<li>
		   <label for="optQuality-button" class="pv-select-label">Quality </label>
		   <select style="display: none;" id="optQuality" name="optQuality">
				<option selected="selected">Squares</option>
				<option>Circles</option>
				<option>Interpolation</option>
				<option value="Splats">HQ-Splats</option>
			</select><span aria-disabled="false" aria-labelledby="ui-id-22" aria-activedescendant="ui-id-22" style="width: 239px;" aria-haspopup="true" aria-owns="optQuality-menu" aria-autocomplete="list" aria-expanded="false" role="combobox" id="optQuality-button" tabindex="0" class="ui-selectmenu-button ui-widget ui-state-default ui-corner-all"><span class="ui-icon ui-icon-triangle-1-s"></span><span class="ui-selectmenu-text">Squares</span></span>
		</li>		
	   
		<li><label class="menu-item"><input onclick="viewer.setShowSkybox(this.checked)" type="checkbox">&nbsp;Skybox</label></li>
		
		<li class="pv-divider"></li>
		<li class="pv-menu-list-header">Eye-Dome-Lighting</li>
		
		<li><label><input id="chkEDLEnabled" onclick="viewer.setEDLEnabled(this.checked)" type="checkbox">&nbsp;enable</label></li>
		<li>radius: <span id="lblEDLRadius">1.9</span><div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sldEDLRadius"><span style="left: 29.3333%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div></li>
		<li>strength: <span id="lblEDLStrength">0.4</span><div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sldEDLStrength"><span style="left: 7.8%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div></li>
		
		</ul>
	   
	  </div>
	  <h3 tabindex="-1" aria-expanded="false" aria-selected="true" aria-controls="ui-id-4" id="ui-id-3" role="tab" class="ui-accordion-header ui-state-default ui-accordion-icons accordion-header-active ui-state-active ui-corner-top"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-s"></span>Navigation</h3>
	  <div aria-hidden="true" role="tabpanel" aria-labelledby="ui-id-3" id="ui-id-4" style="display: block;" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom accordion-content-active">
		<ul class="pv-menu-list">
			<li id="navigation"><img class="button-icon" style="width: 32px; height: 32px;" title="Earth Controls" src="portal_files/earth_controls_1.png"><img class="button-icon" style="width: 32px; height: 32px;" title="Flight Controls" src="portal_files/fps_controls.png"><img class="button-icon" style="width: 32px; height: 32px;" title="Orbit Controls" src="portal_files/orbit_controls.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="focus on pointcloud" src="portal_files/focus.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="top view" src="portal_files/topview.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="front view" src="portal_files/frontview.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="left view" src="portal_files/leftview.svg"></li>
			<li><label><input onclick="viewer.setDEMCollisionsEnabled(this.checked)" type="checkbox">&nbsp;keep above ground</label></li>
			<li>move speed <span id="lblMoveSpeed">86.4</span><div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sldMoveSpeed"><span style="left: 30%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div></li>
		</ul>
	  </div>
	  <h3 tabindex="-1" aria-expanded="false" aria-selected="false" aria-controls="ui-id-6" id="ui-id-5" role="tab" class="ui-accordion-header ui-state-default ui-accordion-icons ui-corner-all"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Tools</h3>
	  <div aria-hidden="true" role="tabpanel" aria-labelledby="ui-id-5" id="ui-id-6" style="display: none;" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom">
		<ul class="pv-menu-list">
		<li id="tools"><img class="button-icon" style="width: 32px; height: 32px;" title="angle measurements" src="portal_files/angle.png"><img class="button-icon" style="width: 32px; height: 32px;" title="angle measurements" src="portal_files/point.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="distance measurements" src="portal_files/distance.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="area measurements" src="portal_files/area.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="volume measurements" src="portal_files/volume.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="height profiles" src="portal_files/profile.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="clipping volumes" src="portal_files/clip_volume.svg"><img class="button-icon" style="width: 32px; height: 32px;" title="remove all measurements" src="portal_files/reset_tools.svg"></li>
		</ul>
	  </div>
	  <h3 tabindex="-1" aria-expanded="false" aria-selected="false" aria-controls="ui-id-8" id="ui-id-7" role="tab" class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Measurements</h3>
	  <div aria-hidden="true" role="tabpanel" aria-labelledby="ui-id-7" id="ui-id-8" style="display: none;" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom">
		<ul class="pv-menu-list selectable" id="measurement_details"></ul>
	  </div>
	  <h3 tabindex="-1" aria-expanded="false" aria-selected="false" aria-controls="ui-id-10" id="ui-id-9" role="tab" class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Material</h3>
	  <div aria-hidden="true" role="tabpanel" aria-labelledby="ui-id-9" id="ui-id-10" style="display: none;" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom">
		<ul class="pv-menu-list">
		<li>
		   <label for="optMaterial-button" class="pv-select-label">Select Attribute </label><br>
		   <select style="display: none;" id="optMaterial" name="optMaterial">
		   <option selected="selected" id="optMaterial_RGB">RGB</option><option id="optMaterial_Color">Color</option><option id="optMaterial_Elevation">Elevation</option><option id="optMaterial_Intensity">Intensity</option><option id="optMaterial_Intensity Gradient">Intensity Gradient</option><option id="optMaterial_Classification">Classification</option><option id="optMaterial_Return Number">Return Number</option><option id="optMaterial_Source">Source</option><option id="optMaterial_Phong">Phong</option><option id="optMaterial_Level of Detail">Level of Detail</option></select><span aria-disabled="false" aria-labelledby="ui-id-26" aria-activedescendant="ui-id-26" style="width: 98px;" aria-haspopup="true" aria-owns="optMaterial-menu" aria-autocomplete="list" aria-expanded="false" role="combobox" id="optMaterial-button" tabindex="0" class="ui-selectmenu-button ui-widget ui-state-default ui-corner-all"><span class="ui-icon ui-icon-triangle-1-s"></span><span class="ui-selectmenu-text">RGB</span></span>
		</li>
		
		<li>Elevation Range: <span id="lblHeightRange">-355.47 to 240.04</span> <div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sldHeightRange"><div style="left: -6.5431e-7%; width: 100%;" class="ui-slider-range ui-widget-header ui-corner-all"></div><span style="left: -6.5431e-7%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span><span style="left: 100%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div>	</li>
		
		</ul>
		<!--<ul id="materialList" class="pv-menu-list"></ul>-->
	  </div>
	  <h3 tabindex="-1" aria-expanded="false" aria-selected="false" aria-controls="ui-id-12" id="ui-id-11" role="tab" class="ui-accordion-header ui-state-default ui-accordion-icons ui-corner-all"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Scene</h3>
	  <div aria-hidden="true" role="tabpanel" aria-labelledby="ui-id-11" id="ui-id-12" style="display: none;" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom">
		<ul id="sceneList" class="pv-menu-list"><li><label class="menu-item" for="scene_list_item_pointcloud_0" id="scene_list_item_label_pointcloud_0"><input checked="checked" id="scene_list_item_pointcloud_0" type="checkbox"> point cloud 0</label></li></ul>
	  </div>
	  <h3 tabindex="-1" aria-expanded="false" aria-selected="false" aria-controls="ui-id-14" id="ui-id-13" role="tab" class="ui-accordion-header ui-state-default ui-accordion-icons ui-corner-all"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Classification Filter</h3>
	  <div aria-hidden="true" role="tabpanel" aria-labelledby="ui-id-13" id="ui-id-14" style="display: none;" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom">
		<ul id="classificationList" class="pv-menu-list"><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_0" type="checkbox"> never classified</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_1" type="checkbox"> unclassified</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_2" type="checkbox"> ground</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_3" type="checkbox"> low vegetation</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_4" type="checkbox"> medium vegetation</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_5" type="checkbox"> high vegetation</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_6" type="checkbox"> building</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_7" type="checkbox"> low point(noise)</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_8" type="checkbox"> key-point</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_9" type="checkbox"> water</label></li><li><label style="white-space: nowrap;"><input checked="checked" id="chkClassification_12" type="checkbox"> overlap</label></li></ul>
	  </div>
	   <h3 tabindex="-1" aria-expanded="false" aria-selected="true" aria-controls="ui-id-16" id="ui-id-15" role="tab" class="ui-accordion-header ui-state-default ui-accordion-icons accordion-header-active ui-state-active ui-corner-top"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-s"></span>Settings</h3>
	  <div aria-hidden="true" role="tabpanel" aria-labelledby="ui-id-15" id="ui-id-16" style="display: block;" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom accordion-content-active">
		<ul class="pv-menu-list">
			<li>Min Node Size: <span id="lblMinNodeSize"></span><div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sldMinNodeSize"><span style="left: 10%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div>	</li>
			<li>
			   <label for="optClipMode-button" class="pv-select-label">Clip Mode </label>
			   <select style="display: none;" id="optClipMode" name="optClipMode">
					<option>No Clipping</option>
					<option selected="selected">Highlight Inside</option>
					<option>Clip Outside</option>
				</select><span aria-disabled="false" aria-labelledby="ui-id-37" aria-activedescendant="ui-id-37" style="width: 98px;" aria-haspopup="true" aria-owns="optClipMode-menu" aria-autocomplete="list" aria-expanded="false" role="combobox" id="optClipMode-button" tabindex="0" class="ui-selectmenu-button ui-widget ui-state-default ui-corner-all"><span class="ui-icon ui-icon-triangle-1-s"></span><span class="ui-selectmenu-text">Highlight Inside</span></span>
			</li>
			<li><label><input onclick="viewer.setShowBoundingBox(this.checked)" type="checkbox">&nbsp;show bounding box</label></li>
			<li><label><input checked="checked" onclick="viewer.setFreeze(this.checked)" type="checkbox">&nbsp;freeze</label></li>
		
		</ul>
	  </div>
	  <h3 tabindex="-1" aria-expanded="false" aria-selected="false" aria-controls="ui-id-18" id="ui-id-17" role="tab" class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>About</h3>
	  <div aria-hidden="true" role="tabpanel" aria-labelledby="ui-id-17" id="ui-id-18" style="display: none;" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom">
		<ul class="pv-menu-list">
			<li><a href="http://potree.org/" target="_blank">Potree</a> is a viewer for large point cloud / LIDAR data sets, developed at the Vienna University of Technology. 
			<a href="https://github.com/potree/potree" target="_blank">(github)</a>
			</li>
			<li>Author: <a href="mailto:mschuetz@potree.org">Markus Schütz</a></li>
			<li>License: <a target="_blank" href="http://potree.org/wp/potree_license/">FreeBSD (2-clause BSD)</a><a></a></li><a>
			</a><li><a>Libraries:
				</a><ul><a>
					</a><li><a></a><a target="_blank" href="http://threejs.org/">three.js</a></li>
					<li><a target="_blank" href="https://jquery.com/">Jquery</a></li>
					<li><a target="_blank" href="http://www.laszip.org/">laszip</a></li>
					<li><a target="_blank" href="https://github.com/verma/plasio">Plas.io (laslaz) </a></li>
					<li><a target="_blank" href="http://openlayers.org/">OpenLayers3</a></li>
					<li><a target="_blank" href="http://proj4js.org/">proj4js</a></li>
					<li><a target="_blank" href="https://github.com/tweenjs/tween.js/">tween</a></li>
				</ul>
			</li>
			<li>Donators:
				<ul>
					<li><a target="_blank" href="http://rapidlasso.com/">rapidlasso</a></li>
					<li><a target="_blank" href="https://georepublic.info/en/">georepublic</a></li>
					<li><a target="_blank" href="http://sitn.ne.ch/">sitn</a></li>
					<li><a target="_blank" href="http://www.veesus.com/veesus/index.php">Veesus</a></li>
					<li><a target="_blank" href="http://sigeom.ch/">sigeom sa</a></li>
				</ul>
			</li>
			<li>Credits:
				<ul>
					<li><a target="_blank" href="https://www.cg.tuwien.ac.at/staff/MichaelWimmer.html">Michael Wimmer</a> &amp; 
						<a target="_blank" href="https://www.cg.tuwien.ac.at/staff/ClausScheiblauer.html">Claus Scheiblauer</a></li>
					<li><a target="_blank" href="https://www.cg.tuwien.ac.at/">TU Wien, Insitute of Computer Graphics and Algorithms</a></li>
					<li><a target="_blank" href="https://harvest4d.org/">Harvest4D</a></li>
					<li><a target="_blank" href="http://rapidlasso.com/">rapidlasso</a></li>
					<li><a target="_blank" href="https://georepublic.info/en/">georepublic</a></li>
					<li><a target="_blank" href="http://hobu.co/">Howard Butler, Uday Verma, Connor Manning</a></li>
					<li><a target="_blank" href="http://www.danielgm.net/cc/">Cloud Compare</a></li>
					<li><a target="_blank" href="http://sitn.ne.ch/">sitn</a></li>
				</ul>
			</li>
		
		</ul>
	  </div>
	  <!--
	  <h3>Help</h3>
	  <div>
		<p>
		Cras dictum. Pellentesque habitant morbi tristique senectus et netus
		et malesuada fames ac turpis egestas. Vestibulum ante ipsum primis in
		faucibus orci luctus et ultrices posuere cubilia Curae; Aenean lacinia
		mauris vel est.
		</p>
		<p>
		Suspendisse eu nisl. Nullam ut libero. Integer dignissim consequat lectus.
		Class aptent taciti sociosqu ad litora torquent per conubia nostra, per
		inceptos himenaeos.
		</p>
	  </div>
	  -->
	</div>

</div>


<script>

var createToolIcon = function(icon, title, callback){
	var elImg = document.createElement("img");
	elImg.src = icon;
	elImg.title = title;
	elImg.onclick = callback;
	elImg.style.width = "32px";
	elImg.style.height = "32px";
	elImg.classList.add("button-icon");
	
	return elImg;
};

function initToolbar(){
	var elToolbar = document.getElementById("tools");
	
	elToolbar.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/angle.png",
		"angle measurements",
		function(){viewer.measuringTool.startInsertion({showDistances: false, showAngles: true, showArea: false, closed: true, maxMarkers: 3})}
	));
	
	elToolbar.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/point.svg",
		"angle measurements",
		function(){viewer.measuringTool.startInsertion({showDistances: false, showAngles: false, showCoordinates: true, showArea: false, closed: true, maxMarkers: 1})}
	));
	
	elToolbar.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/distance.svg",
		"distance measurements",
		function(){viewer.measuringTool.startInsertion({showDistances: true, showArea: false, closed: false})}
	));
	
	elToolbar.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/area.svg",
		"area measurements",
		function(){viewer.measuringTool.startInsertion({showDistances: true, showArea: true, closed: true})}
	));
	
	elToolbar.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/volume.svg",
		"volume measurements",
		function(){viewer.volumeTool.startInsertion()}
	));
	
	elToolbar.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/profile.svg",
		"height profiles",
		function(){viewer.profileTool.startInsertion()}
	));
	
	elToolbar.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/clip_volume.svg",
		"clipping volumes",
		function(){viewer.volumeTool.startInsertion({clip: true})}
	));
	
	elToolbar.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/reset_tools.svg",
		"remove all measurements",
		function(){
			viewer.measuringTool.reset();
			viewer.profileTool.reset();
			viewer.volumeTool.reset();
		}
	));
}

function initMaterials(){
	
	$( "#optMaterial" ).selectmenu({
		style:'popup',
		position: { 
			my: "top", 
			at: "bottom", 
			collision: "flip" }	
	});
		
	$( "#sldHeightRange" ).slider({
		range: true,
		min:	0,
		max:	1000,
		values: [0, 1000],
		step: 	0.01,
		slide: function( event, ui ) {
			var local = {
				min: viewer.toLocal(new THREE.Vector3(0, 0, ui.values[0])).y,
				max: viewer.toLocal(new THREE.Vector3(0, 0, ui.values[1])).y,
			};
			viewer.setHeightRange(local.min, local.max);
		}
	});

	var updateHeightRange = function(){
		var box = viewer.getBoundingBox();
		var geoMin = viewer.toGeo(box.min).z;
		var geoMax = viewer.toGeo(box.max).z;
		
		var hr = viewer.getHeightRange();
		var hrGeo = {
			min: viewer.toGeo(new THREE.Vector3(0, hr.min, 0)).z,
			max: viewer.toGeo(new THREE.Vector3(0, hr.max, 0)).z,
		};
		
		var vMin = hr.min ? hrGeo.min : geoMin;
		var vMax = hr.max ? hrGeo.max : geoMax;
		
		$( '#lblHeightRange')[0].innerHTML = hrGeo.min.toFixed(2) + " to " + hrGeo.max.toFixed(2);
		$( "#sldHeightRange" ).slider({
			min: geoMin,
			max: geoMax,
			values: [vMin, vMax]
		});
	};
	
	viewer.addEventListener("height_range_changed", function(event){
		updateHeightRange();
		var hr = viewer.getHeightRange();
		var hrGeo = {
			min: viewer.toGeo(new THREE.Vector3(0, hr.min, 0)).z,
			max: viewer.toGeo(new THREE.Vector3(0, hr.max, 0)).z,
		};
		
		$( '#lblHeightRange')[0].innerHTML = hrGeo.min.toFixed(2) + " to " + hrGeo.max.toFixed(2);
		$( "#sldHeightRange" ).slider({values: [hrGeo.min, hrGeo.max]});
	});
	
	viewer.addEventListener("pointcloud_loaded", updateHeightRange);
	
	updateHeightRange();
	
	//var hr = viewer.getHeightRange();
	//$('#lblHeightRange')[0].innerHTML = hr.min.toFixed(2) + " to " + hr.max.toFixed(2);

	var options = [ 
		"RGB", 
		"Color", 
		"Elevation", 
		"Intensity", 
		"Intensity Gradient", 
		"Classification", 
		"Return Number", 
		"Source", 
		"Phong",
		"Level of Detail"	
	];
	
	var elMaterialList = document.getElementById("optMaterial");
	for(var i = 0; i < options.length; i++){
		var option = options[i];
		
		var elOption = document.createElement("option");
		elOption.innerHTML = option;
		elOption.id = "optMaterial_" + option;
		
		elMaterialList.appendChild(elOption);
	}
	
	$("#optMaterial").val(viewer.getMaterialName()).selectmenu("refresh")
	$("#optMaterial").selectmenu({
		change: function(event, ui){
			viewer.setMaterial(ui.item.value);
		}
	});
}

function initClassificationList(){
	var addClassificationItem = function(code, name){
		var elClassificationList = document.getElementById("classificationList");
		
		var elLi = document.createElement("li");
		var elLabel = document.createElement("label");
		var elInput = document.createElement("input");
		var elText = document.createTextNode(" " + name);
		
		elInput.id = "chkClassification_" + code;
		elInput.type = "checkbox";
		elInput.checked = true;
		elInput.onclick = function(event){
			viewer.setClassificationVisibility(code, event.target.checked);
		}
		
		elLabel.style.whiteSpace = "nowrap";
		
		elClassificationList.appendChild(elLi);
		elLi.appendChild(elLabel);
		elLabel.appendChild(elInput);
		elLabel.appendChild(elText);
	};
	
	addClassificationItem(0, "never classified");
	addClassificationItem(1, "unclassified");
	addClassificationItem(2, "ground");
	addClassificationItem(3, "low vegetation");
	addClassificationItem(4, "medium vegetation");
	addClassificationItem(5, "high vegetation");
	addClassificationItem(6, "building");
	addClassificationItem(7, "low point(noise)");
	addClassificationItem(8, "key-point");
	addClassificationItem(9, "water");
	addClassificationItem(12, "overlap");
}

function initAccordion(){
	$('#accordion').accordion({
		autoHeight: true,
		heightStyle: "content",
        collapsible:true,
        beforeActivate: function(event, ui) {
             // The accordion believes a panel is being opened
            if (ui.newHeader[0]) {
                var currHeader  = ui.newHeader;
                var currContent = currHeader.next('.ui-accordion-content');
             // The accordion believes a panel is being closed
            } else {
                var currHeader  = ui.oldHeader;
                var currContent = currHeader.next('.ui-accordion-content');
            }
             // Since we've changed the default behavior, this detects the actual status
            var isPanelSelected = currHeader.attr('aria-selected') == 'true';
            
             // Toggle the panel's header
            currHeader.toggleClass('ui-corner-all',isPanelSelected).toggleClass('accordion-header-active ui-state-active ui-corner-top',!isPanelSelected).attr('aria-selected',((!isPanelSelected).toString()));
            
            // Toggle the panel's icon
            currHeader.children('.ui-icon').toggleClass('ui-icon-triangle-1-e',isPanelSelected).toggleClass('ui-icon-triangle-1-s',!isPanelSelected);
            
             // Toggle the panel's content
            currContent.toggleClass('accordion-content-active',!isPanelSelected)    
            if (isPanelSelected) { currContent.slideUp(); }  else { currContent.slideDown(); }

            return false; // Cancels the default action
        }
    });
}

function initAppearance(){

	$( "#optPointSizing" ).selectmenu();
	$( "#optQuality" ).selectmenu();
	
	$("#optPointSizing").val(viewer.getPointSizing()).selectmenu("refresh")
	$("#optPointSizing").selectmenu({
		change: function(event, ui){
			viewer.setPointSizing(ui.item.value);
		}
	});
	
	$("#optQuality").val(viewer.getQuality()).selectmenu("refresh")
	$("#optQuality").selectmenu({
		change: function(event, ui){
			viewer.setQuality(ui.item.value);
		}
	});


	$( "#sldPointBudget" ).slider({
		value: viewer.getPointBudget(),
		min: 100*1000,
		max: 5*1000*1000,
		step: 1000,
		slide: function( event, ui ) {viewer.setPointBudget(ui.value);}
	});
	
	$( "#sldPointSize" ).slider({
		value: viewer.getPointSize(),
		min: 0,
		max: 3,
		step: 0.01,
		slide: function( event, ui ) {viewer.setPointSize(ui.value);}
	});
	
	$( "#sldFOV" ).slider({
		value: viewer.getFOV(),
		min: 20,
		max: 100,
		step: 1,
		slide: function( event, ui ) {viewer.setFOV(ui.value);}
	});
	
	$( "#sldOpacity" ).slider({
		value: viewer.getOpacity(),
		min: 0,
		max: 1,
		step: 0.01,
		slide: function( event, ui ) {viewer.setOpacity(ui.value);}
	});
	
	$( "#sldEDLRadius" ).slider({
		value: viewer.getEDLRadius(),
		min: 1,
		max: 4,
		step: 0.01,
		slide: function( event, ui ) {viewer.setEDLRadius(ui.value);}
	});
	
	$( "#sldEDLStrength" ).slider({
		value: viewer.getEDLStrength(),
		min: 0,
		max: 5,
		step: 0.01,
		slide: function( event, ui ) {viewer.setEDLStrength(ui.value);}
	});
	
	viewer.addEventListener("point_budget_changed", function(event){
		$( '#lblPointBudget')[0].innerHTML = Potree.utils.addCommas(viewer.getPointBudget());
		$( "#sldPointBudget" ).slider({value: viewer.getPointBudget()});
	});
	
	viewer.addEventListener("point_size_changed", function(event){
		$('#lblPointSize')[0].innerHTML = viewer.getPointSize().toFixed(2);
		$( "#sldPointSize" ).slider({value: viewer.getPointSize()});
	});
	
	viewer.addEventListener("fov_changed", function(event){
		$('#lblFOV')[0].innerHTML = parseInt(viewer.getFOV());
		$( "#sldFOV" ).slider({value: viewer.getFOV()});
	});
	
	viewer.addEventListener("opacity_changed", function(event){
		$('#lblOpacity')[0].innerHTML = viewer.getOpacity().toFixed(2);
		$( "#sldOpacity" ).slider({value: viewer.getOpacity()});
	});
	
	viewer.addEventListener("edl_radius_changed", function(event){
		$('#lblEDLRadius')[0].innerHTML = viewer.getEDLRadius().toFixed(1);
		$( "#sldEDLRadius" ).slider({value: viewer.getEDLRadius()});
	});
	
	viewer.addEventListener("edl_strength_changed", function(event){
		$('#lblEDLStrength')[0].innerHTML = viewer.getEDLStrength().toFixed(1);
		$( "#sldEDLStrength" ).slider({value: viewer.getEDLStrength()});
	});
	
	
	$('#lblPointBudget')[0].innerHTML = Potree.utils.addCommas(viewer.getPointBudget());
	$('#lblPointSize')[0].innerHTML = viewer.getPointSize().toFixed(2);
	$('#lblFOV')[0].innerHTML = parseInt(viewer.getFOV());
	$('#lblOpacity')[0].innerHTML = viewer.getOpacity().toFixed(2);
	$('#lblEDLRadius')[0].innerHTML = viewer.getEDLRadius().toFixed(1);
	$('#lblEDLStrength')[0].innerHTML = viewer.getEDLStrength().toFixed(1);
}
	
	
function initNavigation(){

	var elNavigation = document.getElementById("navigation");
	
	elNavigation.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/earth_controls_1.png",
		"Earth Controls",
		function(){viewer.useEarthControls()}
	));
	
	
	elNavigation.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/fps_controls.png",
		"Flight Controls",
		function(){viewer.useFPSControls()}
	));
	
	elNavigation.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/orbit_controls.svg",
		"Orbit Controls",
		function(){viewer.useOrbitControls()}
	));
	
	elNavigation.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/focus.svg",
		"focus on pointcloud",
		function(){viewer.fitToScreen()}
	));
	
	elNavigation.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/topview.svg",
		"top view",
		function(){viewer.setTopView()}
	));
	
	elNavigation.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/frontview.svg",
		"front view",
		function(){viewer.setFrontView()}
	));
	
	elNavigation.appendChild(createToolIcon(
		Potree.resourcePath + "/icons/leftview.svg",
		"left view",
		function(){viewer.setLeftView()}
	));
	
	var speedRange = new THREE.Vector2(1, 10*1000);
	
	var toLinearSpeed = function(value){
		return Math.pow(value, 4) * speedRange.y + speedRange.x;
	};
	
	var toExpSpeed = function(value){
		return Math.pow((value - speedRange.x) / speedRange.y, 1 / 4);
	};

	$( "#sldMoveSpeed" ).slider({
		value: toExpSpeed( viewer.getMoveSpeed() ),
		min: 0,
		max: 1,
		step: 0.01,
		slide: function( event, ui ) { viewer.setMoveSpeed(toLinearSpeed(ui.value)); }
	});
	
	viewer.addEventListener("move_speed_changed", function(event){
		$('#lblMoveSpeed')[0].innerHTML = viewer.getMoveSpeed().toFixed(1);
		$( "#sldMoveSpeed" ).slider({value: toExpSpeed(viewer.getMoveSpeed())});
	});
	
	$('#lblMoveSpeed')[0].innerHTML = viewer.getMoveSpeed().toFixed(1);
}

function initMeasurementDetails(){

	//<li>
	//		<div class="panel panel-default">
	//		  <div class="panel-heading pv-panel-heading" style="display: flex; flex-direction: row">
	//			<img src="../resources/icons/distance.png" style="width: 16px; height: 16px" /> 
	//			<span style="flex-grow:1"> </span>
	//			<img src="../resources/icons/remove.svg" style="width: 16px; height: 16px" /> 
	//		  </div>
	//		  <div class="panel-body">
	//			<div class="measurement-detail-node-marker" >423, 413, 75464</div>
	//			<div class="measurement-detail-edge" > </div>
	//			<div class="measurement-detail-node-distance" > 12,001.37 </div>
	//			<div class="measurement-detail-edge" > </div>
	//			<div class="measurement-detail-node-marker" >423, 413, 75464</div>
	//			<div class="measurement-detail-edge" > </div>
	//			<div class="measurement-detail-node-distance" > 97 </div>
	//			<div class="measurement-detail-edge" > </div>
	//			<div class="measurement-detail-node-marker" >423, 413, 75464</div>
	//		  </div>
	//		</div>
	//	</li>
	
	var id = 0;
	
	var callback = function(event){
	
		id++;
	
		var measurement = event.measurement;
		var profile = event.profile;
		var volume = event.volume;
	
		var elLi = document.createElement("li");
		var elPanel = document.createElement("div");
		var elPanelHeader = document.createElement("div");
		var elPanelBody = document.createElement("div");
		var elPanelIcon = document.createElement("img");
		var elPanelStretch = document.createElement("span");
		var elPanelRemove = document.createElement("img");
		
		elPanel.classList.add("potree-panel", "panel-default");
		elPanelHeader.classList.add("potree-panel-heading", "pv-panel-heading");
		
		if(measurement){
			if(measurement.showDistances && !measurement.showArea && !measurement.showAngles){
				elPanelIcon.src = Potree.resourcePath + "/icons/distance.svg";
				elPanelStretch.innerHTML = "Distance";
			}else if(measurement.showDistances && measurement.showArea && !measurement.showAngles){
				elPanelIcon.src = Potree.resourcePath + "/icons/area.svg";
				elPanelStretch.innerHTML = "Area";
			}else if(measurement.maxMarkers === 1){
				elPanelIcon.src = Potree.resourcePath + "/icons/point.svg";
				elPanelStretch.innerHTML = "Coordinate";
			}else if(!measurement.showDistances && !measurement.showArea && measurement.showAngles){
				elPanelIcon.src = Potree.resourcePath + "/icons/angle.png";
				elPanelStretch.innerHTML = "Angle";
			}
			
			elPanelRemove.onclick = function(){viewer.measuringTool.removeMeasurement(measurement);};
		}else if(profile){
			elPanelIcon.src = Potree.resourcePath + "/icons/profile.svg";
			elPanelRemove.onclick = function(){viewer.profileTool.removeProfile(profile);};
			
			elPanelStretch.innerHTML = "Profile";
		}else if(volume){
			elPanelIcon.src = Potree.resourcePath + "/icons/volume.svg";
			elPanelRemove.onclick = function(){viewer.measuringTool.removeVolume(volume);};
			
			elPanelStretch.innerHTML = "Volume";
		}
		
		elPanelIcon.style.width = "16px";
		elPanelIcon.style.height = "16px";
		elPanelStretch.style.flexGrow = 1;
		elPanelStretch.style.textAlign = "center";
		elPanelRemove.src = Potree.resourcePath + "/icons/remove.svg";
		elPanelRemove.style.width = "16px";
		elPanelRemove.style.height = "16px";
		elPanelBody.classList.add("panel-body");
		
		elLi.appendChild(elPanel);
		elPanel.appendChild(elPanelHeader);
		elPanelHeader.appendChild(elPanelIcon);
		elPanelHeader.appendChild(elPanelStretch);
		elPanelHeader.appendChild(elPanelRemove);
		elPanel.appendChild(elPanelBody);
		//elPanelBody.appendChild(document.createTextNode("lala"));
		
		//$('#measurement_details').append(elLi);
		document.getElementById("measurement_details").appendChild(elLi);
		
		var widthListener;
		var updateDisplay = function(event){
		
			if(profile){
				if(widthListener){
					profile.removeEventListener("width_changed", widthListener);
				}
			}
		
			$(elPanelBody).empty();
			
			if(profile){
				//<li>Point Budget: <span id="lblPointBudget"></span> <div id="sldPointBudget"></div>	</li>
				
				var elLi = $('<li style="margin-bottom: 5px">');
				var elText = document.createTextNode("width: ");
				var elWidthLabel = $('<span id="lblProfileWidth_' + id + '">');
				var elWidthSlider = $('<div id="sldProfileWidth_' + id + '">');
				
				elWidthSlider.slider({
					value: Math.pow((profile.getWidth() / 1000), 1/4).toFixed(3),
					min: 0,
					max: 1,
					step: 0.01,
					slide: function(event, ui){
						var val = Math.pow(ui.value, 4) * 1000;
						profile.setWidth(val);
					}
				});
				if(profile.getWidth()){
					elWidthLabel.html(Potree.utils.addCommas(profile.getWidth().toFixed(3)));
				}else{
					elWidthLabel.html("-");
				}
				
				widthListener = function(event){
					var val = Math.pow((event.width / 1000), 1/4);
					elWidthLabel.html(Potree.utils.addCommas(event.width.toFixed(3)));
					elWidthSlider.slider({value: val});
				};
				profile.addEventListener("width_changed", widthListener);
				
				elLi.append(elText);
				elLi.append(elWidthLabel);
				elLi.append(elWidthSlider);
				
				elPanelBody.appendChild(elLi[0]);
			}
			
			var positions = [];
			var points;
			if(measurement){
				points = measurement.points;
				for(var i = 0; i < points.length; i++){
					positions.push(points[i].position);
				}
			}else if(profile){
				positions = profile.points;
			}else if(volume){
				positions = [volume.getWorldPosition()];
			}
			
			for(var i = 0; i < positions.length; i++){
				var point = positions[i];
				var geoCoord = viewer.toGeo(point);
	
				var txt = geoCoord.x.toFixed(2) + ", ";
				txt += geoCoord.y.toFixed(2) + ", ";
				txt += geoCoord.z.toFixed(2);
				
				var elNodeMarker = $('<div>').addClass("measurement-detail-node-marker");
				elNodeMarker.html(txt);
				
				$(elPanelBody).append(elNodeMarker);
				
				if(i < positions.length - 1){
					if(measurement && measurement.showDistances){
						
						var elEdge = $('<div>').addClass("measurement-detail-edge");
						$(elPanelBody).append(elEdge);
						
						var nextPoint = positions[i+1];
						var nextGeo = viewer.toGeo(nextPoint);
						var distance = nextGeo.distanceTo(geoCoord);
						var txt = Potree.utils.addCommas(distance.toFixed(2));
						
						var elNodeDistance = $('<div>').addClass("measurement-detail-node-distance");
						elNodeDistance.html(txt);
						
						$(elPanelBody).append(elNodeDistance);
						
						//var elEdge = $('<div>').addClass("measurement-detail-edge");
						//$(elPanelBody).append(elEdge);
					}
				}
				
				if(measurement && measurement.showAngles){
					var elEdge = $('<div>').addClass("measurement-detail-edge");
					$(elPanelBody).append(elEdge);
					
					var angle = measurement.getAngle(i);
					var txt = Potree.utils.addCommas((angle*(180.0/Math.PI)).toFixed(1)) + '\u00B0';
					var elNodeAngle = $('<div>').addClass("measurement-detail-node-angle");
					elNodeAngle.html(txt);
					$(elPanelBody).append(elNodeAngle);
					
					//if(i < positions.length - 1){
					//	var elEdge = $('<div>').addClass("measurement-detail-edge");
					//	$(elPanelBody).append(elEdge);
					//}
				}
				
				if(i < positions.length - 1){
					var elEdge = $('<div>').addClass("measurement-detail-edge");
					$(elPanelBody).append(elEdge);
				}
			}
			
			if(points && points.length === 1){
				var point = points[0];
				
				var elTable = $('<table>').css("width", "100%");
				$(elPanelBody).append(elTable);
				
				if(point.color){
					var color = point.color;
					
					var elTr = $('<tr>');
					var elKey = $('<td>').css("padding", "1px 5px");
					var elValue = $('<td>').css("width", "100%").css("padding", "1px 5px");
					
					var value = parseInt(color[0] * 255) 
						+ ", " + parseInt(color[1] * 255) 
						+ ", " + parseInt(color[2] * 255);
					
					elKey.html("rgb");
					elValue.html(value);
					
					elTable.append(elTr);
					elTr.append(elKey);
					elTr.append(elValue);
				}
				
				if(typeof point.intensity !== "undefined"){
					var intensity = point.intensity;
					
					var elTr = $('<tr>');
					var elKey = $('<td>').css("padding", "1px 5px");
					var elValue = $('<td>').css("width", "100%").css("padding", "1px 5px");
					
					elKey.html("intensity");
					elValue.html(intensity);
					
					elTable.append(elTr);
					elTr.append(elKey);
					elTr.append(elValue);
				}
				
				if(typeof point.classification !== "undefined"){
					var classification = point.classification;
					
					var elTr = $('<tr>');
					var elKey = $('<td>').css("padding", "1px 5px");
					var elValue = $('<td>').css("width", "100%").css("padding", "1px 5px");
					
					elKey.html("classification");
					elValue.html(classification);
					
					elTable.append(elTr);
					elTr.append(elKey);
					elTr.append(elValue);
				}
				
				if(typeof point.returnNumber !== "undefined"){
					var returnNumber = point.returnNumber;
					
					var elTr = $('<tr>');
					var elKey = $('<td>').css("padding", "1px 5px");
					var elValue = $('<td>').css("width", "100%").css("padding", "1px 5px");
					
					elKey.html("return nr.");
					elValue.html(returnNumber);
					
					elTable.append(elTr);
					elTr.append(elKey);
					elTr.append(elValue);
				}
				
				if(typeof point.pointSourceID !== "undefined"){
					var source = point.pointSourceID;
					
					var elTr = $('<tr>');
					var elKey = $('<td>').css("padding", "1px 5px");
					var elValue = $('<td>').css("width", "100%").css("padding", "1px 5px");
					
					elKey.html("source");
					elValue.html(source);
					
					elTable.append(elTr);
					elTr.append(elKey);
					elTr.append(elValue);
				}
				
				
			}
			
			if(measurement && measurement.showArea){
				var txt = Potree.utils.addCommas(measurement.getArea().toFixed(1)) + "²";
				
				var elNodeArea = $('<div>').addClass("measurement-detail-node-area");
				elNodeArea.html(txt);
				
				$(elPanelBody).append(elNodeArea);
			}
			
			if(profile){
				// show 2d profile button
				var elOpenProfileWindow = $('<input type="button" value="show 2d profile">')
					.addClass("measurement-detail-button");
				elOpenProfileWindow[0].onclick = function(){
					viewer._2dprofile.show();
					viewer._2dprofile.draw(profile);
				};
				$(elPanelBody).append(elOpenProfileWindow);
				
				//// download points in profile button
				//var elDownloadProfileLink = document.createElement("a");
				//elDownloadProfileLink.href = "#";
				//elDownloadProfileLink.download = "profile.las";
				//
				//var elDownloadProfileButton = $('<input type="button" value="download">')
				//	.addClass("measurement-detail-button");
				//elDownloadProfileButton[0].onclick = function(){
				//	var las = viewer._2dprofile.getLAS();
				//	var u8view = new Uint8Array(las);
				//	
				//	var binString = "";
				//	for(var i = 0; i < u8view.length; i++){
				//		binString += String.fromCharCode(u8view[i]);
				//	}
				//	
				//	var uri = "data:application/octet-stream;base64,"+btoa(binString);
				//	elDownloadProfileLink.href = uri;
				//};
				//
				//elDownloadProfileLink.appendChild(elDownloadProfileButton[0]);
				//
				//$(elPanelBody).append(elDownloadProfileLink);
			}
			
		};
		
		updateDisplay();
		
		if(measurement){
			viewer.measuringTool.addEventListener("marker_added", updateDisplay);
			viewer.measuringTool.addEventListener("marker_removed", updateDisplay);
			viewer.measuringTool.addEventListener("marker_moved", updateDisplay);
			viewer.measuringTool.addEventListener("measurement_removed", function(event){
				if(event.measurement === measurement){
					viewer.measuringTool.removeEventListener("marker_added", updateDisplay);
					viewer.measuringTool.removeEventListener("marker_removed", updateDisplay);
					viewer.measuringTool.removeEventListener("marker_moved", updateDisplay);
					$(elLi).remove();
				}
			});
		}else if(profile){
			viewer.profileTool.addEventListener("marker_added", updateDisplay);
			viewer.profileTool.addEventListener("marker_removed", updateDisplay);
			viewer.profileTool.addEventListener("marker_moved", updateDisplay);
			viewer.profileTool.addEventListener("profile_removed", function(event){
				if(event.profile === profile){
					viewer.profileTool.removeEventListener("marker_added", updateDisplay);
					viewer.profileTool.removeEventListener("marker_removed", updateDisplay);
					viewer.profileTool.removeEventListener("marker_moved", updateDisplay);
					$(elLi).remove();
				}
			});
		}
	};
	
	for(var i = 0; i < viewer.measuringTool.measurements.length; i++){
		callback({measurement: viewer.measuringTool.measurements[i]});
	}
	
	for(var i = 0; i < viewer.profileTool.profiles.length; i++){
		callback({profile: viewer.profileTool.profiles[i]});
	}

	viewer.measuringTool.addEventListener("measurement_added", callback);
	viewer.profileTool.addEventListener("profile_added", callback);
	viewer.volumeTool.addEventListener("volume_added", callback);
};

function initSceneList(){

	// <li>
	// <label class="menu-item">
	// <input type="checkbox" onClick="viewer.setShowSkybox(this.checked)"/>
	// &nbsp;Skybox
	// </label>
	// </li>
	var scenelist = $('#sceneList');
	
	var id = 0;
	// this works but it looks so wrong. any better way to create a closure around pointcloud?
	var addPointcloud = function(pointcloud){
		(function(pointcloud){
			var elLi = $('<li>');
			var elLabel = $('<label>');
			var elInput = $('<input type="checkbox">');
			
			elInput[0].checked = true;
			elInput[0].id = "scene_list_item_pointcloud_" + id;
			elLabel[0].id = "scene_list_item_label_pointcloud_" + id;
			elLabel[0].htmlFor = "scene_list_item_pointcloud_" + id;
			elLabel.addClass("menu-item");
			elInput.click(function(event){
				pointcloud.visible = event.target.checked;
				if(viewer._2dprofile){
					viewer._2dprofile.redraw();
				}
			});
			
			elLi.append(elLabel);
			elLabel.append(elInput);
			var pointcloudName = " " + (pointcloud.name ? pointcloud.name : "point cloud " + id);
			var elPointCloudName = document.createTextNode(pointcloudName);
			elLabel.append(elPointCloudName);
			
			scenelist.append(elLi);
			
			pointcloud.addEventListener("name_changed", function(e){
				if(e.name){
					elPointCloudName.textContent = " " + e.name;
				}else{
					elPointCloudName.textContent = " point cloud " + id;
				}
			});
			
			id++;
		})(pointcloud);
	};
	
	for(var i = 0; i < viewer.pointclouds.length; i++){
		var pointcloud = viewer.pointclouds[i];
		addPointcloud(pointcloud);
	}
	
	viewer.addEventListener("pointcloud_loaded", function(event){
		addPointcloud(event.pointcloud);
	});
};

initSettings = function(){
	//<li>Min Node Size: <span id="lblMinNodeSize"></span><div id="sldMinNodeSize"></div>	</li>
	
	$( "#sldMinNodeSize" ).slider({
		value: viewer.getMinNodeSize(),
		min: 0,
		max: 1000,
		step: 0.01,
		slide: function( event, ui ) {viewer.setMinNodeSize(ui.value);}
	});
	
	viewer.addEventListener("minnodesize_changed", function(event){
		$('#lblMinNodeSize')[0].innerHTML = parseInt(viewer.getMinNodeSize());
		$( "#lblMinNodeSize" ).slider({value: viewer.getMinNodeSize()});
	});
	
	
	var toClipModeCode = function(string){
		if(string === "No Clipping"){
			return Potree.ClipMode.DISABLED;
		}else if(string === "Highlight Inside"){
			return Potree.ClipMode.HIGHLIGHT_INSIDE;
		}else if(string === "Clip Outside"){
			return Potree.ClipMode.CLIP_OUTSIDE;
		}
	};
	
	var toClipModeString = function(code){
		if(code === Potree.ClipMode.DISABLED){
			return "No Clipping";
		}else if(code === Potree.ClipMode.HIGHLIGHT_INSIDE){
			return "Highlight Inside";
		}else if(code === Potree.ClipMode.CLIP_OUTSIDE){
			return "Clip Outside";
		}
	};
	
	$("#optClipMode").selectmenu();
	$("#optClipMode").val(toClipModeString(viewer.getClipMode())).selectmenu("refresh")
	$("#optClipMode").selectmenu({
		change: function(event, ui){
			viewer.setClipMode(toClipModeCode(ui.item.value));
		}
	});
};


$(document).ready( function() {
    
	initAccordion();
	initAppearance();
	initToolbar();
	initNavigation();
	initMaterials();
	initClassificationList();
	initMeasurementDetails();
	initSceneList();
	initSettings()
	
	$('#potree_version_number').html(Potree.version.major + "." + Potree.version.minor + Potree.version.suffix);
	
});











	
</script></div>
    </div>
	
	<script>
	
		var onPointCloudLoaded = function(event){
			// do stuff here that should be executed whenever a point cloud has been loaded.
			// event.pointcloud returns the point cloud object
			console.log("a point cloud has been loaded");
		}; 
	
		viewer = new Potree.Viewer(document.getElementById("potree_render_area"), {
			"onPointCloudLoaded": onPointCloudLoaded
		});
		
		viewer.setEDLEnabled(false);
		viewer.setPointSize(3);
		viewer.setMaterial("RGB");
		viewer.setFOV(60);
		viewer.setPointSizing("Fixed");
		viewer.setQuality("Squares");
		viewer.setPointBudget(1*1000*1000);
		
		document.title = "My Portal";
		viewer.setEDLEnabled(true);
		viewer.setShowSkybox(true);
		viewer.setMaterialID(Potree.PointColorType.ELEVATION);
		viewer.setDescription('');
		
		viewer.loadSettingsFromURL();

		viewer.addPointCloud("pointclouds/portal/cloud.js");
		
		viewer.loadGUI();
		
	</script><div style="position: fixed; bottom: 40px; width: 200px; margin-left: -100px; left: 50%; border-radius: 5px; border: 1px solid rgb(114, 118, 120); height: 16px; padding: 1px; text-align: center; background-color: rgb(107, 168, 229); opacity: 0; pointer-events: none; transition: all 0.2s ease 0s;"><div style="background-color: rgb(184, 225, 252); position: absolute; border-radius: 5px; width: 0%; height: 100%; margin: 0px; padding: 0px;"> </div><div style="position: absolute; width: 100%;">loading: NaN%</div></div>
  

<div class="ui-selectmenu-menu ui-front"><ul aria-disabled="false" aria-activedescendant="ui-id-19" tabindex="0" role="listbox" class="ui-menu ui-widget ui-widget-content ui-corner-bottom" id="optPointSizing-menu" aria-labelledby="optPointSizing-button" aria-hidden="true"><li role="option" tabindex="-1" id="ui-id-19" class="ui-menu-item ui-state-focus">Fixed</li><li role="option" tabindex="-1" id="ui-id-20" class="ui-menu-item">Attenuated</li><li role="option" tabindex="-1" id="ui-id-21" class="ui-menu-item">Adaptive</li></ul></div><div style="top: 244px; left: 21px;" class="ui-selectmenu-menu ui-front"><ul style="width: 241px;" aria-disabled="false" aria-activedescendant="ui-id-22" tabindex="0" role="listbox" class="ui-menu ui-widget ui-widget-content ui-corner-bottom" id="optQuality-menu" aria-labelledby="optQuality-button" aria-hidden="true"><li role="option" tabindex="-1" id="ui-id-22" class="ui-menu-item ui-state-focus">Squares</li><li role="option" tabindex="-1" id="ui-id-23" class="ui-menu-item">Circles</li><li role="option" tabindex="-1" id="ui-id-24" class="ui-menu-item">Interpolation</li><li role="option" tabindex="-1" id="ui-id-25" class="ui-menu-item">HQ-Splats</li></ul></div><div class="ui-selectmenu-menu ui-front"><ul aria-disabled="false" aria-activedescendant="ui-id-26" tabindex="0" role="listbox" class="ui-menu ui-widget ui-widget-content ui-corner-bottom" id="optMaterial-menu" aria-labelledby="optMaterial-button" aria-hidden="true"><li role="option" tabindex="-1" id="ui-id-26" class="ui-menu-item ui-state-focus">RGB</li><li role="option" tabindex="-1" id="ui-id-27" class="ui-menu-item">Color</li><li role="option" tabindex="-1" id="ui-id-28" class="ui-menu-item">Elevation</li><li role="option" tabindex="-1" id="ui-id-29" class="ui-menu-item">Intensity</li><li role="option" tabindex="-1" id="ui-id-30" class="ui-menu-item">Intensity Gradient</li><li role="option" tabindex="-1" id="ui-id-31" class="ui-menu-item">Classification</li><li role="option" tabindex="-1" id="ui-id-32" class="ui-menu-item">Return Number</li><li role="option" tabindex="-1" id="ui-id-33" class="ui-menu-item">Source</li><li role="option" tabindex="-1" id="ui-id-34" class="ui-menu-item">Phong</li><li role="option" tabindex="-1" id="ui-id-35" class="ui-menu-item">Level of Detail</li></ul></div><div class="ui-selectmenu-menu ui-front"><ul aria-disabled="false" aria-activedescendant="ui-id-37" tabindex="0" role="listbox" class="ui-menu ui-widget ui-widget-content ui-corner-bottom" id="optClipMode-menu" aria-labelledby="optClipMode-button" aria-hidden="true"><li role="option" tabindex="-1" id="ui-id-36" class="ui-menu-item">No Clipping</li><li role="option" tabindex="-1" id="ui-id-37" class="ui-menu-item ui-state-focus">Highlight Inside</li><li role="option" tabindex="-1" id="ui-id-38" class="ui-menu-item">Clip Outside</li></ul></div></body></html>